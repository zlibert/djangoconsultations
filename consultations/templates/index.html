{% extends "base_generic.html" %}

{% block content %}

<h1>Consultations</h1>

{% if userIsStaff %}
<p>Search by username : </p>
{% else %}
<br>
<div class="container-fluid">
    <button type="button" class="btn btn-success" onclick="location.href='add'">Create New Consultation</button>
</div>
{% endif %}
{% if messages %}
    {% for message in messages %}
        {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}
            <div class="alert alert-danger" role="alert">
                {{ message }}
            </div>
        {% elif message.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %}
            <div class="alert alert-success" role="alert">
                {{ message }}
            </div>
        {% endif %}	
    {% endfor %}
{% endif %}

{% if waiting_for_payment_consultations %}
<div class="container-fluid">  
    <h3>Waiting for Payment (waiting payment confirmation)</h3>
        <table class="table table-hover">
            <thead class="thead-light">
            <tr>
                <th scope="col">#</th>
                <th scope="col">User</th>
                <th scope="col">Symptoms</th>
                <th scope="col">Assigned to</th>
            </tr>
            </thead>
            <tbody>
            {% for consultation in waiting_for_payment_consultations %}
            <tr onclick="window.location='{% url 'consultations:detail' consultation.id %}';">
                <th scope="row"> {{ consultation.id }}</th>
                <td>{{ consultation.requester }}</td>
                <td>{{ consultation.current_symptoms }}</td>
                <td>{{ consultation.assigned_to }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
</div>
{% endif %}

{% if waiting_for_patient_consultations %}
<div class="container-fluid">  
    <h3>Waiting for Patient (waiting for patient response)</h3>
        <table class="table table-hover">
            <thead class="thead-light">
            <tr>
                <th scope="col">#</th>
                <th scope="col">User</th>
                <th scope="col">Symptoms</th>
                <th scope="col">Assigned to</th>
            </tr>
            </thead>
            <tbody>
            {% for consultation in waiting_for_patient_consultations %}
            <tr onclick="window.location='{% url 'consultations:detail' consultation.id %}';">
                <th scope="row"> {{ consultation.id }}</th>
                <td>{{ consultation.requester }}</td>
                <td>{{ consultation.current_symptoms }}</td>
                <td>{{ consultation.assigned_to }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
</div>
{% endif %}

{% if open_consultations %}
<div class="container-fluid">   
    <h3>Open (not assigned yet)</h3>
    
        <table class="table table-hover">
            <thead class="thead-light">
            <tr>
                <th scope="col">#</th>
                <th scope="col">User</th>
                <th scope="col">Symptoms</th>
                <th scope="col">Assigned to</th>
            </tr>
            </thead>
            <tbody>
            {% for consultation in open_consultations %}
            <tr onclick="window.location='{% url 'consultations:detail' consultation.id %}';">
                <th scope="row"> {{ consultation.id }}</th>
                <td>{{ consultation.requester }}</td>
                <td>{{ consultation.current_symptoms }}</td>
                <td>{{ consultation.assigned_to }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
</div> 
{% endif %}

{% if pending_consultations %}
<div class="container-fluid">
    <h3>Pending (waiting for our response)</h3>

        <table class="table table-hover">
            <thead class="thead-light">
            <tr>
                <th scope="col">#</th>
                <th scope="col">User</th>
                <th scope="col">Symptoms</th>
                <th scope="col">Assigned to</th>
            </tr>
            </thead>
            <tbody>
            {% for consultation in pending_consultations %}
            <tr onclick="window.location='{% url 'consultations:detail' consultation.id %}';">
                <th scope="row"> {{ consultation.id }}</th>
                <td>{{ consultation.requester }}</td>
                <td>{{ consultation.current_symptoms }}</td>
                <td>{{ consultation.assigned_to }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
</div>
{% endif %}


{% if resolved_consultations %}
<div class="container-fluid">  
    <h3>Resolved</h3>
        <table class="table table-hover">
            <thead class="thead-light">
            <tr>
                <th scope="col">#</th>
                <th scope="col">User</th>
                <th scope="col">Symptoms</th>
                <th scope="col">Assigned to</th>
            </tr>
            </thead>
            <tbody>    
            {% for consultation in resolved_consultations %}
            <tr onclick="window.location='{% url 'consultations:detail' consultation.id %}';">
                <th scope="row"> {{ consultation.id }}</th>
                <td>{{ consultation.requester }}</td>
                <td>{{ consultation.current_symptoms }}</td>
                <td>{{ consultation.assigned_to }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
</div>
{% endif %}

{% if closed_consultations %}
<div class="container-fluid">  
    <h3>Closed</h3>
        <table class="table table-hover">
            <thead class="thead-light">
            <tr>
                <th scope="col">#</th>
                <th scope="col">User</th>
                <th scope="col">Symptoms</th>
                <th scope="col">Assigned to</th>
            </tr>
            </thead>
            <tbody>    
            {% for consultation in closed_consultations %}
            <tr onclick="window.location='{% url 'consultations:detail' consultation.id %}';">
                <th scope="row"> {{ consultation.id }}</th>
                <td>{{ consultation.requester }}</td>
                <td>{{ consultation.current_symptoms }}</td>
                <td>{{ consultation.assigned_to }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
</div>
{% endif %}

{% if rejected_consultations %}
<div class="container-fluid">  
    <h3>Rejected</h3>
        <table class="table table-hover">
            <thead class="thead-light">
            <tr>
                <th scope="col">#</th>
                <th scope="col">User</th>
                <th scope="col">Symptoms</th>
                <th scope="col">Assigned to</th>
            </tr>
            </thead>
            <tbody>    
            {% for consultation in closed_consultations %}
            <tr onclick="window.location='{% url 'consultations:detail' consultation.id %}';">
                <th scope="row"> {{ consultation.id }}</th>
                <td>{{ consultation.requester }}</td>
                <td>{{ consultation.current_symptoms }}</td>
                <td>{{ consultation.assigned_to }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
</div>
{% endif %}

{% endblock %}